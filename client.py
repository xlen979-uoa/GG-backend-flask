import requests
import json


def id_test(mmsi):
    url = f"http://127.0.0.1:443/get/shipID?mmsi={mmsi}"
    res = requests.get(url)
    data = json.loads(res.content.decode('utf-8'))
    return data


def picture_test(ship_id):
    url = f"http://127.0.0.1:443/get/shipPicture?ship_id={ship_id}"
    res = requests.get(url)
    data = json.loads(res.content.decode('utf-8'))
    print(data)
    return res


def get_pollution(mmsi):
    # url = f"https://flask.marinehub.online:443/get/pollution?mmsi={mmsi}"
    # url = f"http://3.104.55.204:8080/get/pollution?mmsi={mmsi}" #aws
    # url = f"http://47.242.8.47:8080/get/pollution?mmsi={mmsi}" #ali
    url = f"http://127.0.0.1:443/get/pollution?mmsi={mmsi}"
    res = requests.get(url)
    data = json.loads(res.content.decode('utf-8'))
    print(data)
    return res

def get_total_pollution(mmsi):
    # url = f"https://flask.marinehub.online:443/get/total_pollution?mmsi={mmsi}"
    # url = f"http://13.236.117.100:8081/get/total_pollution?mmsi={mmsi}" old aws
    # url = f"http://3.104.55.204:8080/get/total_pollution?mmsi={mmsi}" #aws
    # url = f"http://47.242.8.47:8080/get/total_pollution?mmsi={mmsi}" #aws
    url = f"http://127.0.0.1:443/get/total_pollution?mmsi={mmsi}"

    res = requests.get(url)
    data = json.loads(res.content.decode('utf-8'))
    print(data)
    return res

if __name__ == '__main__':
    res = id_test(372417000)
    print(res)
    pic = picture_test(res["vessel_id"])
    print(pic)
    # res = id_test(413795981) #4671150
    # get_pollution(512011106)

    get_pollution(512005156)
    get_total_pollution(512005156)

    mmsi_list=[
"338185704",
"413386920",
"249995000",
"246501000",
"538002661",
"210070000",
"211360020",
"244750675",
"412429424",
"98339829",
"249891000",
"211243920",
"227277040",
"991176602",
"413869932",
"242049100",
"563096500",
"205760610",
"244730905",
"232007876",
"601087000",
"525100355",
"636017877",
"211558410",
"237017700",
"211523600",
"316007862",
"412440842",
"538004444",
"413363540",
"431301588",
"553111885",
"211715360",
"257207000",
"372154000",
"265757140",
"368061350",
"425000003",
"431004507",
"412366767",
"590623636",
"236729000",
"255805810",
"259677000",
"250005313",
"367139770",
"367709820",
"538009297",
"273453080",
"224440330",
"503117460",
"564267000",
"525024397",
"413963579",
"525003414",
"244750099",
"413229370",
"636018003",
"211183290",
"368049820",
"257157640",
"538006432",
"345070257",
"413325420",
"775994680",
"367587710",
"431601676",
"565687000",
"273299020",
"636019508",
"413474550",
"257877700",
"994171415",
"231522000",
"244060938",
"244820731",
"225996232",
"413695850",
"257133620",
"503000154",
"355116000",
"230998340",
"642122129",
"244700957",
"412047610",
"247190940",
"219003141",
"441588000",
"257162000",
"477685300",
"311046700",
"245467000",
"416003508",
"211769280",
"226015350",
"231862000",
"416006135",
"367544060",
"249430000",
"225994031",
"477713200",
"503131260",
"219027988",
"258288000",
"636021004",
"236216000",
"244014053",
"503500800",
"367003590",
"627258000",
"368195880",
"273676767",
"477552800",
"525107008",
"248783000",
"414403140",
"209867000",
"273366360",
"244317050",
"412337647",
"271072729",
"440063450",
"414223000",
"413487550",
"353619000",
"370473000",
"413835479",
"258065000",
"405000199",
"312058004",
"367041840",
"368102290",
"261526000",
"246479000",
"405000306",
"413771788",
"413844943",
"352001656",
"352949000",
"256399000",
"273293230",
"305505000",
"416008964",
"413986601",
"319199700",
"369465000",
"654045600",
"371658000",
"657166500",
"503734400",
"224146540",
"269057381",
"477948300",
"244780921",
"248334000",
"244710846",
"412549361",
"224045880",
"319140900",
"273372890",
"710122031",
"273396990",
"622121422",
"227503000",
"431006557",
"371182000",
"357242000",
"414435000",
"244133767",
"244130332",
"264163087",
"466334000",
"369060000",
"239299000",
"538070070",
"351352000",
"224098930",
"414726000",
"257078800",
"412320026",
"416460000",
"257457000",
"244660009",
"636012254",
"419123428",
"525015479",
"232013525",
"371278000",
"244189187",
"577564000",
"533000339",
"431000748",
"701006704",
"503029110",
"416236800",
"423217100",
"627221000",
"244770628",
"412549002",
"636020769",
"538003914",
"413791438",
"228376700",
"257593000",
"477237500",
"226007560",
"477793800",
"257880500",
"735059027",
"431003439",
"249947000",
"563064150",
"244710352",
"319483000",
"367046090",
"636021829",
"367727250",
"224004380",
"636092952",
"273341530",
"211543810",
"525015960",
"431016957",
"563021040",
"205870130",
"636013814",
"538005064",
"538003763",
"338183069",
"257047000",
"413994285",
"231812000",
"219002726",
"413377870",
"538006805",
"636019985",
"269057484",
"800047344",
"244790594",
"235072062",
"211455560",
"414334000",
"413906177",
"413865319",
"92080206",
"431005219",
"413572545",
"408801000",
"219011448",
"413959715",
"271050241",
"413368960",
"503032880",
"677098300",
"413864407",
"273318930",
"354555000",
"244780130",
"636015871",
"735060035",
"368207890",
"367002510",
"636016702",
"577336000",
"255805802",
"248026000",
"273416760",
"366963470",
"338879000",
"413791379",
"900013028",
"413844947",
"413906097",
"377427000",
"245747000",
"230008800",
"413470920",
"416251900",
"413255660",
"431014167",
"563974000",
"235112247",
"231184000",
"367665030",
"412436670",
"232018240",
"432829000",
"211755400",
"219030424",
"264900318",
"237697000",
"374583000",
"273031211",
"636015143",
"538002349",
"40065701",
"413844657",
"636016450",
"636019384",
"525007241",
"412694940",
"538009322",
"253779000",
"371351000",
"525800785",
"366933870",
"273458810",
"235107992",
"354827000",
"304036000",
"219007472",
"219024515",
"211552710",
"246759000",
"316005444",
"577358000",
"574709047",
"311758000",
"265575480",
"356691000",
"273897000",
"244645000",
"368038000",
"247285500",
"368046350",
"538007899",
"412704240",
"312369000",
"725000628",
"229582000",
"205413990",
"273455910",
"211215130",
"273211900",
"368176220",
"440079720",
"636091959",
"710010830",
"367622080",
"775998861",
"352181000",
"258002430",
"477638400",
"257144700",
"994008436",
"311000845",
"209151000",
"219158000",
"235060655",
"413834541",
"367767250",
"413304170",
"247206000",
"413213620",
"244620972",
"412375180",
"244729310",
"470130000",
"412327216",
"538007270",
"249918000",
"240362500",
"636017539",
"271049542",
"645683000",
"413814691",
"248644000",
"563081500",
"367569830",
"247160340",
"338301307",
"257008300",
"538003886",
"356557000",
"371305000",
"368084090",
"367481060",
"431051000",
"477995284",
"413794043",
"232030062",
"310774000",
"371977000",
"636021578",
"219275000",
"367789310",
"440007060",
"431301665",
"211511160",
"345070198",
"265524640",
"440158360",
"511100710",
"503771700",
"316001257",
"235107648",
"325635000",
"226013850",
"413906629",
"413826373",
"259883000",
"244900067",
"371995000",
"416005639",
"548905000",
"211624810",
"563113400",
"258010970",
"413285190",
"224595000",
"373075000",
"413843653",
"205420690",
"538007040",
"370289000",
"211172030",
"258012440",
"311000607",
"368245920",
"414400040",
"413860385",
"310487000",
"312190000",
"244615094",
"338372419",
"416007396",
"224030330",
"229603000",
"740338000",
"273293380",
"525101641",
"413292810",
"563135700",
"241576000",
"273365230",
"341494000",
"538008559",
"235108934",
"277542000",
"345070413",
"413245410",
"265609530",
"108080047",
"431007281",
"503046320",
"235117932",
"416000501",
"413261560",
"636093052",
"311426000",
"244660531",
"244012874",
"273426250",
"212125000",
"256505000",
"518100665",
"431400908",
"9127806",
"413983537",
"244633000",
"538009734",
"264900253",
"338181104",
"657506000",
"319179500",
"538005825",
"316037084",
"503051160",
"211671480",
"229016000",
"477234600",
"538005865",
"477995437",
"636021716",
"352986188",
"367393290",
"413997515",
"413702420",
"367192940",
"368156970",
"538090601",
"413826168",
"701006653",
"244670612",
"227447480",
"373871000",
"310720000",
"636017805",
"219018133",
"636021776",
"211848160",
"247257400",
"273424560",
"210497000",
"367430050",
"518998179",
"577366000",
"271062130",
"636013195",
"412222224",
"414622000",
"525121015",
"310612000",
"219023842",
"211658150",
"228058000",
"341534000",
"98352503",
"372339000",
"563027200",
"250006617",
"319047600",
"367700110",
"413820859",
"244308000",
"273321060",
"219021291",
"263442000",
"538005814",
"636017055",
"273444380",
"228397800",
"351108000",
"563092700",
"566670000",
"413299880",
"370805000",
"563078100",
"200000836",
"369970566",
"413996718",
"538005482",
"366914430",
"994008610",
"413843528",
"229396000",
"503039680",
"710232729",
"533006700",
"525003639",
"258412000",
"247433600",
"209419000",
"211706910",
"257673500",
"470952000",
"503786000",
"224609000",
"219020900",
"311000636",
"370411000",
"244890219",
"339254000",
"1",
"273354390",
"211748780",
"538006462",
"338432915",
"210281000",
"431017216",
"345010015",
"367079510",
"241452000",
"412221521",
"636016014",
"273299190",
"368213563",
"367741770",
"533110691",
"219030509",
"601936000",
"413593730",
"548310500",
"255806177",
"574430000",
"211457570",
"503051520",
"413440940",
"431200703",
"211326550",
"367100060",
"538004153",
"477056800",
"273350610",
"230145760",
"725019110",
"265612300",
"229000498",
"241694000",
"563128100",
"256002866",
"423134100",
"412756290",
"636092708",
"367313760",
"636015773",
"234979000",
"259279000",
"269057417",
"232026833",
"204232000",
"256040000",
"367333920",
"247219700",
"416003265",
"232013527",
"244270859",
"412549459",
"477537600",
"319250000",
"219000558",
"279202159",
"374745000",
"245381000",
"229472000",
"225988582",
"370885000",
"412321938",
"367501160",
"503042580",
"219028794",
"257010250",
"368115890",
"730154392",
"657145600",
"533170381",
"412670005",
"338407000",
"413800064",
"413999212",
"413247020",
"503305400",
"205413090",
"538007451",
"440017000",
"240417400",
"246371000",
"538009525",
"247383500",
"247312140",
"413234340",
"428003005",
"211375020",
"218044000",
"413868028",
"520272000",
"512003332",
"374652000",
"413846629",
"431300599",
"211170540",
"431018272",
"419900390",
"228027720",
"338444176",
"205414130",
"311000453",
"368255460",
"269057543",
"247580000",
"657181500",
"413868471",
"211277360",
"538001736",
"338346695",
"667001468",
"227410840",
"567065500",
"408576000",
"367316450",
"316013544",
"244730043",
"319137100",
"205650000",
"338312275",
"249810000",
"338085738",
"355518000",
"538009886",
"248000939",
"304490000",
"374262000",
"355157000",
"710005670",
"368228540",
"548600500",
"413280750",
"412331414",
"273849700",
"477963900",
"354094000",
"636020958",
"273365350",
"256462000",
"316014646",
"574012084",
"273338300",
"229452000",
"477241300",
"258283000",
"525007230",
"563071100",
"503123590",
"413986582",
"525024193",
"316003285",
"271043491",
"431015179",
"368086140",
"431013062",
"431347000",
"311873000",
"211458210",
"372953000",
"413800000",
"416004521",
"636021600",
"244100994",
"316029422",
"376746000",
"203999394",
"413224810",
"310755000",
"311027500",
"412328766",
"245162000",
"419076600",
"273341890",
"372854000",
"413997221",
"259360000",
"994010634",
"246767000",
"413263760",
"275486000",
"259004170",
"413781973",
"311042500",
"413784232",
"412288528",
"431662000",
"352001621",
"431302000",
"636018365",
"477185800",
"224175430",
"355048000",
"240186200",
"355220000",
"413847993",
"316037596",
"577562000",
"512007971",
"312918000",
"371272000",
"244130641",
"636018811",
"211521700",
"413771291",
"413696490",
"574001830",
"209836000",
"244170872",
"431401907",
"1234565",
"413998535",
"566756000",
"412011140",
"538008524",
"413972235",
"477182800",
"205459490",
"503121060",
"413303020",
"422030800",
"232028822",
"338392952",
"412333795",
"416002916",
"230182000",
"412333492",
"503101180",
"257010430",
"601367500",
"244690285",
"244407000",
"264900275",
"645159000",
"413838768",
"563016950",
"265810790",
"244850275",
"319122700",
"244839000",
"368113580",
"419479000",
"525900076",
"211627240",
"538008902",
"271010456",
"413896000",
"412320211",
"305305000",
"241804000",
"211549000",
"431012994",
"356285000",
"230357000",
"373069000",
"257982000",
"636021010",
"311000248",
"574014631",
"770576131",
"257844740",
"273240900",
"432787000",
"416002876",
"211689370",
"316003150",
"413209930",
"219021688",
"258179000",
"563084700",
"412360940",
"352165000",
"413462150",
"257034490",
"238204140",
"413341640",
"412550010",
"636020447",
"244060311",
"244210086",
"367092410",
"574002011",
"636018094",
"368130050",
"412020540",
"316017978",
"271073128",
"316011649",
"257944700",
"503113860",
"701000819",
"538005110",
"574000157",
"538005270",
"273364260",
"413834044",
"413961751",
"419900762",
"314635000",
"368246910",
"352636000",
"413822268",
"244336000",
"470495000",
"636093115",
"538009644",
"371568000",
"273326410",
"538009631",
"232008342",
"257055860",
"416005223",
"413846029",
"264163285",
"431015065",
"219026119",
"273324800",
"312911000",
"440010800",
"273455780",
"538006871",
"368043790",
"215320000",
"316048574",
"414258000",
"538010098",
"244170085",
"503003450",
"572510220",
"413849941",
"538006446",
"248917000",
"205503990",
"245772000",
"538071663",
"366773480",
"244020840",
"366896060",
"431400303",
"413793262",
"312745000",
"564614000",
"412549363",
"413989637",
"368015160",
"244830948",
"261011540",
"994171184",
"253203000",
"244650780",
"413288660",
"219022011",
"525016753",
"431002172",
"257076980",
"422108000",
"257790000",
"440159630",
"345050006",
"775993200",
"258241000",
"740422000",
"413793055",
"564282000",
"413844948",
"219004069",
"367053160",
"374880000",
"440116550",
"111111955",
"311000967",
"440008830",
"244134276",
"431009524",
"412371207",
"273325180",
"413827403",
"730151804",
"224377000",
"413277550",
"259040000",
"246342000",
"725003217",
"412437380",
"255806448",
"225987868",
"511100378",
"273390170",
"538008502",
"257249000",
"525119142",
"211124510",
"244722317",
"470654000",
"413895000",
"244700673",
"994037415",
"237829800",
"227211680",
"538071537",
"244830719",
"367699890",
"533170229",
"316002655",
"224583000",
"477685900",
"211833230",
"338420853",
"414283000",
"345030109",
"538006289",
"431500615",
"630001004",
"367756070",
"413299410",
"413867766",
"312278000",
"546023500",
"258394000",
"374229000",
"378112993",
"538009395",
"413284560",
"244790658",
"538010069",
"211590310",
"265523490",
"244890481",
"245692000",
"477698300",
"657606000",
"244128475",
"710033090",
"725005800",
"244005653",
"244090810",
"211171290",
"416005402",
"244740400",
"257068120",
"574101369",
"367644590",
"264162101",
"636017688",
"563097600",
"211147040",
"642122129",
"227002280",
"244058084",
"247179600",
"269057649",
"211222960",
"525004085",
"273366150",
"525006222",
"269087721",
"548976500",
"244690781",
"316033461",
"567002681",
"244650757",
"232002836",
"735059894",
"601239200",
"211504090",
"204701440",
"578315576",
"257006070",
"316042165",
"440046510",
"316007865",
"316004946",
"503628500",
"265767620",
"232003596",
"211170960",
"211682330",
"368059840",
"431015964",
"235073501",
"244042197",
]
    # for mmsi in mmsi_list:
    #     get_total_pollution(mmsi)
